# .gitignore Configuration

## Overview

The repository now has comprehensive `.gitignore` files to prevent committing build artifacts, generated code, and temporary files.

## Files Created/Updated

### 1. Root `.gitignore`
**Location**: `/orchestrator/.gitignore`

**Excludes**:
- ✅ **Generated code**: `crates/dag-optimizer/src/types.rs`, `cmd/orchestrator/models/generated/`
- ✅ **Go artifacts**: `bin/`, coverage files, vendor
- ✅ **Rust artifacts**: `target/`, `Cargo.lock`, `*.rs.bk`
- ✅ **WASM builds**: `*.wasm`, `pkg/`
- ✅ **Node.js**: `node_modules/`, build outputs
- ✅ **Logs**: `logs/`, `*.log`
- ✅ **Runtime**: `.pids/`, `data/`
- ✅ **IDE files**: `.vscode/`, `.idea/`, etc.
- ✅ **OS files**: `.DS_Store`, `Thumbs.db`
- ✅ **Environment**: `.env` files

### 2. dag-optimizer `.gitignore`
**Location**: `/orchestrator/crates/dag-optimizer/.gitignore`

**Specifically excludes**:
- `src/types.rs` (generated from schema - don't commit!)
- `target/` (build artifacts)
- `pkg/` (WASM artifacts)

### 3. CLI `.gitignore` (Updated)
**Location**: `/orchestrator/cmd/aob-cli/.gitignore`

**Now includes**:
- Environment files
- Logs
- Additional editor patterns

## Important: Generated Code

### ⚠️ DO NOT COMMIT THESE FILES

The following files are **automatically generated** from schemas:

```
crates/dag-optimizer/src/types.rs          # Generated by: make generate-rust-types
cmd/orchestrator/models/generated/*.go     # Generated by: make generate-go-types
```

**Why?**
- They're derived from `common/schema/*.schema.json` (the source of truth)
- They change every time the schema is updated
- Committing them causes merge conflicts
- They can be regenerated anytime with `make generate-types`

### ✅ DO COMMIT THESE FILES

- `common/schema/*.schema.json` - The source schemas (source of truth)
- `common/schema/examples/*.json` - Example workflows
- All other source code

## Workflow

### For Developers

```bash
# 1. Clone repo
git clone <repo>

# 2. Generate types (first time)
make generate-types

# 3. Develop
# Edit schemas, write code...

# 4. Before committing
git status  # Should NOT show types.rs or generated/ files

# 5. Commit
git add .
git commit -m "Your changes"
```

### Updating Schemas

```bash
# 1. Edit schema
vim common/schema/workflow.schema.json

# 2. Regenerate types
make generate-types

# 3. Commit only the schema
git add common/schema/workflow.schema.json
git commit -m "Update workflow schema: add new node type"

# The generated types.rs and *.go are NOT committed
```

## CI/CD Integration

Your CI/CD pipeline should:

```yaml
steps:
  - checkout
  - setup: node, go, rust
  - run: make generate-types    # Generate types on CI
  - run: make build
  - run: make test
```

This ensures generated code is always fresh and in sync with schemas.

## Verifying .gitignore

```bash
# Check what would be committed
git status

# Should NOT see:
# - crates/dag-optimizer/src/types.rs
# - cmd/orchestrator/models/generated/
# - target/
# - bin/
# - logs/

# If you see these, .gitignore is working correctly!
```

## Troubleshooting

### "Generated files showing up in git status"

If generated files still appear:

```bash
# Remove from git cache (if already tracked)
git rm --cached crates/dag-optimizer/src/types.rs
git rm --cached -r cmd/orchestrator/models/generated/

# Commit the removal
git commit -m "Remove generated files from tracking"
```

### "I need to see what changed in generated code"

Generated code isn't in git, but you can still diff:

```bash
# 1. Before making schema changes
cp crates/dag-optimizer/src/types.rs /tmp/types.rs.backup

# 2. Make schema changes
vim common/schema/workflow.schema.json

# 3. Regenerate
make generate-types

# 4. Compare
diff /tmp/types.rs.backup crates/dag-optimizer/src/types.rs
```

## Summary

✅ Generated code excluded from git
✅ Build artifacts excluded
✅ IDE and OS files excluded
✅ Environment files protected
✅ Cleaner git history
✅ No merge conflicts on generated code
✅ Faster clones (smaller repo)

All developers just need to run `make generate-types` after cloning!
